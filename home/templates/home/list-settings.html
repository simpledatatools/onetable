{% extends "home/layouts/layout-no-side-nav.html" %}
{% load static %}

{% block title %}
    OneTable - Workspace Settings
{% endblock %}

{% block headername %}
  {{ app.name }}
{% endblock %}

{% block headerlink %}
  {% url 'app_details' organization_pk=organization.pk app_pk=app.pk %}
{% endblock %}

{% block header %}
  {% include 'home/layouts/component-header-workspace.html' %}
{% endblock %}

{% block bodyclass %}
  class="bg-white"
{% endblock %}

{% block content %}

<div class="container mt-4">
  <!-- Account page navigation-->
  <header class="page-header page-header-compact page-header-light border-bottom bg-white mb-4">
    <div class="container-fluid">
        <div class="page-header-content">
            <div class="row align-items-center justify-content-between pt-3">
                <div class="col-auto mb-3">
                    <h1 class="page-header-title">
                        <div class="page-header-icon"><i data-feather="settings"></i></div>
                        Settings for {{ list.name }} in {{ app.name }}
                    </h1>
                </div>
            </div>
        </div>
    </div>
  </header>
  <!-- Main page content-->
  <div class="container">
  <div class="row">
      <div class="col-lg-8">
          <!-- Email notifications preferences card-->
          <div class="card card-header-actions mb-4">
              <div class="card-header">
                  List Details
              </div>
              <div class="card-body">
                <p>Edit list details directly under the <a href="{% url 'edit_list' organization_pk=organization.pk app_pk=app.pk list_pk=list.pk %}">edit list fields page</a></p>
                <div class="public_link mb-4">
                  {% if list.is_public %}
                  <a href="javascript:void(0);">{{public_link}}</a>
                  {% endif %}
                </div>
                <p>Make Public
                  <label class="switch pl-5">
                    <input type="checkbox" class="test" {% if list.is_public %}checked{% endif %}>
                    <span class="slider round"></span>
                  </label>
                </p>
              </div>
          </div>
      </div>
      <div class="col-lg-4">
          <!-- Notifications preferences card-->
          <div class="card">
              <div class="card-header">Archive List</div>
              <div class="card-body">
                  <p>You can archive this list if you will no longer use it. Data will still be available under the archived filter and in records.
                  <form method="POST" action="{% url 'archive_list' organization_pk=organization.pk app_pk=app.pk list_pk=list.pk %}">
                    {% csrf_token %}
                    <button type="submit" name="project_id" class="btn btn-danger-soft text-danger">
                      Archive this list
                    </button>
                  </form>
              </div>
          </div>
      </div>
  </div>
</div>

{% endblock %}

{% block extrajs %}
<script>
  $(document).on('click', '.test', function(){
    is_public = $(this).prop('checked');
    $.ajax({
      url: '{% url "change_list_public_flag" organization_pk=organization.pk app_pk=app.pk list_pk=list.pk %}',
      type: 'POST',
      data: {
        'is_public': is_public,
      },
      success: function(response){
        window.location.reload();
      }
    });
  });
</script>
{% endblock %}
